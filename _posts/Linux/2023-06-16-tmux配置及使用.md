---
title: tmux配置及使用
date: 2023-06-16 09:37:00
tags: ["CentOS", "系统", "Linux", "Ubuntu"]
categories: ["Linux"]
render_with_liquid: false
permalink: /posts/2023-06-16-tmux配置及使用/
---

## > 参考链接

> * https://harttle.land/2015/11/06/tmux-startup.html
> * http://www.ruanyifeng.com/blog/2019/10/tmux.html

### tmux 安装

```bash
# Ubuntu 或 Debian

$ sudo apt-get install tmux

# CentOS 或 Fedora

$ yum install tmux -y
$ yum install https://repo.ius.io/7/x86_64/packages/t/tmux2-2.9a-2.el7.ius.x86_64.rpm

# 2.x版本安装

# https://repo.ius.io/

[ius]
name = IUS for Enterprise Linux 7 - $basearch
baseurl = https://repo.ius.io/7/$basearch/
enabled = 1
repo_gpgcheck = 0
gpgcheck = 1
gpgkey = https://example.com/RPM-GPG-KEY-IUS-7

alias tmuxat='tmux ls && read session && tmux -CC attach -t ${session:-default} || tmux -CC new -s ${session:-default}'

# Mac

$ brew install tmux

```

### 启动与退出

##### 安装完成后，键入tmux命令，就进入了 Tmux 窗口。

```text
$ tmux

```

##### 按下Ctrl+d或者显式输入exit命令，就可以退出 Tmux 窗口。

```text
$ exit

```

##### 前缀键

> Tmux 窗口有大量的快捷键。所有快捷键都要通过前缀键唤起。默认的前缀键是Ctrl+b，即先按下Ctrl+b，快捷键才会生效。
> > 举例来说，帮助命令的快捷键是Ctrl+b ?。它的用法是，在 Tmux 窗口中，先按下Ctrl+b，再按下?，就会显示帮助信息。
> > 然后，按下 ESC 键或q键，就可以退出帮助。

### 会话管理

##### 新建会话

第一个启动的 Tmux 窗口，编号是0，第二个窗口的编号是1，以此类推。这些窗口对应的会话，就是 0 号会话、1 号会话。

使用编号区分会话，不太直观，更好的方法是为会话起名。

```bash
$ tmux new -s <session-name>

# 上面命令新建一个指定名称的会话。

```

##### 分离会话

在 Tmux 窗口中，按下Ctrl+b d或者输入tmux detach命令，就会将当前会话与窗口分离。

```bash
$ tmux detach

# 上面命令执行后，就会退出当前 Tmux 窗口，但是会话和里面的进程仍然在后台运行。

```

##### tmux ls命令可以查看当前所有的 Tmux 会话。

```bash
$ tmux ls

# or

$ tmux list-session

```

##### 接入会话

tmux attach命令用于重新接入某个已存在的会话。

```bash
# 使用会话编号

$ tmux attach -t 0

# 使用会话名称

$ tmux attach -t <session-name>

```

##### 杀死会话

tmux kill-session命令用于杀死某个会话

```bash
# 使用会话编号

$ tmux kill-session -t 0

# 使用会话名称

$ tmux kill-session -t <session-name>

```

##### 切换会话

tmux switch命令用于切换会话

```bash
# 使用会话编号

$ tmux switch -t 0

# 使用会话名称

$ tmux switch -t <session-name>

```

##### 重命名会话

tmux rename-session命令用于重命名会话

```bash
$ tmux rename-session -t 0 <new-name>

# 上面命令将0号会话重命名

```

##### 会话快捷键

下面是一些会话相关的快捷键。

> * Ctrl+b d：分离当前会话。
> * Ctrl+b s：列出所有会话。
> * Ctrl+b $：重命名当前会话。

##### 最简操作流程

综上所述，以下是 Tmux 的最简操作流程。

> 1. 新建会话tmux new -s my_session。
> 2. 在 Tmux 窗口运行所需的程序。
> 3. 按下快捷键Ctrl+b d将会话分离。
> 4. 下次使用时，重新连接到会话tmux attach-session -t my_session。

#### 窗格操作

Tmux 可以将窗口分成多个窗格（pane），每个窗格运行不同的命令。以下命令都是在 Tmux 窗口中执行

##### 划分窗格

`tmux split-window`命令用来划分窗格

```bash
# 划分上下两个窗格

$ tmux split-window

# 划分左右两个窗格

$ tmux split-window -h

```

##### 移动光标

`tmux select-pane`命令用来移动光标位置。

```bash
# 光标切换到上方窗格

$ tmux select-pane -U

# 光标切换到下方窗格

$ tmux select-pane -D

# 光标切换到左边窗格

$ tmux select-pane -L

# 光标切换到右边窗格

$ tmux select-pane -R

```

##### 交换窗格位置

`tmux swap-pane`命令用来交换窗格位置。

```bash
# 当前窗格上移

$ tmux swap-pane -U

# 当前窗格下移

$ tmux swap-pane -D

```

##### 窗格快捷键

> 下面是一些窗格操作的快捷键。
> * Ctrl+b %：划分左右两个窗格。
> * Ctrl+b "：划分上下两个窗格。
> * Ctrl+b <arrow key>：光标切换到其他窗格。`<arrow key>`是指向要切换到的窗格的方向键，比如切换到下方窗格，就按方向键↓。
> * Ctrl+b ;：光标切换到上一个窗格。
> * Ctrl+b o：光标切换到下一个窗格。
> * Ctrl+b {：当前窗格左移。
> * Ctrl+b }：当前窗格右移。
> * Ctrl+b Ctrl+o：当前窗格上移。
> * Ctrl+b Alt+o：当前窗格下移。
> * Ctrl+b x：关闭当前窗格。
> * Ctrl+b !：将当前窗格拆分为一个独立窗口。
> * Ctrl+b z：当前窗格全屏显示，再使用一次会变回原来大小。
> * Ctrl+b Ctrl+<arrow key>：按箭头方向调整窗格大小。
> * Ctrl+b q：显示窗格编号。

### 窗口管理

除了将一个窗口划分成多个窗格，Tmux 也允许新建多个窗口。

##### 新建窗口

`tmux new-window`命令用来创建新窗口。

```bash
$ tmux new-window

# 新建一个指定名称的窗口

$ tmux new-window -n <window-name>

```

##### 切换窗口

`tmux select-window`命令用来切换窗口。

```bash
# 切换到指定编号的窗口

$ tmux select-window -t <window-number>

# 切换到指定名称的窗口

$ tmux select-window -t <window-name>

```

##### 重命名窗口

`tmux rename-window`命令用于为当前窗口起名（或重命名）。

```text
$ tmux rename-window <new-name>

```

##### 窗口快捷键

> 下面是一些窗口操作的快捷键。
> * Ctrl+b c：创建一个新窗口，状态栏会显示多个窗口的信息。
> * Ctrl+b p：切换到上一个窗口（按照状态栏上的顺序）。
> * Ctrl+b n：切换到下一个窗口。
> * Ctrl+b <number>：切换到指定编号的窗口，其中的<number>是状态栏上的窗口编号。
> * Ctrl+b w：从列表中选择窗口。
> * Ctrl+b ,：窗口重命名。

### 其他命令

##### 下面是一些其他命令。

```bash
# 列出所有快捷键，及其对应的 Tmux 命令

$ tmux list-keys

# 列出所有 Tmux 命令及其参数

$ tmux list-commands

# 列出当前所有 Tmux 会话的信息

$ tmux info

# 重新加载当前的 Tmux 配置

$ tmux source-file ~/.tmux.conf

```

### tmux 配置

##### 配置文件

```bash
# vim ~/.tmux.conf添加如下行：

# 单词跳格

set-window-option -g xterm-keys on

# set-option -g default-terminal "xterm-256color"

set -g default-terminal screen-256color
set-option -ga terminal-overrides ",*256col*:Tc"

# 重置 前缀(ctrl+a)

set -g prefix C-a
unbind C-b

# 分割窗口

bind j split-window -h
bind h split-window -v

# 重置 关闭窗口

unbind &
bind X confirm-before -p "kill-window #W? (y/n)" kill-window

# 重置 暂停窗口

unbind C-z
bind C-s suspend-client

# 开启鼠标

set -g mouse-resize-pane on
set -g mouse-select-pane on
set -g mouse-select-window on
setw -g  mode-mouse on
set-option -g mouse on #2.1以上的版本参数，不需要上面4个参数。

# 设置连接启动tmux：

# vim ~/.bash_profile

if ! tmux ls > /dev/null; then
  tmux
elif ! tmux ls |grep attached > /dev/null; then
  tmux at
fi

```

---

### tmux 快捷键

> bash 中：

##### 列出所有会话:

```text
tmux ls

```

##### 恢复会话:

```ini
tmux at [-t 会话名]

```

##### 关闭会话:

```text
tmux kill-session -t 会话名

```

> tmux中：

##### 按下 Tmux 前缀 ctrl+b，然后：

- c  创建新窗口
- w  列出所有窗口
- n  后一个窗口
- p  前一个窗口
- f  查找窗口
- ,  重命名当前窗口
- &  关闭当前窗口

##### 窗格（分割窗口）

- j  垂直分割
- h  水平分割
- c-o 移动窗格位置
- 上下键 上一个及下一个窗格
- x  关闭窗格
- z  最大化/最小化窗格(1.8版本以上)
- space  改变窗格布局