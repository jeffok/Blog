---
title: rsync文件同步
date: 2024-09-21 10:50:00
tags: ["OpenStack", "云计算", "Shell", "备份"]
categories: ["Linux"]
render_with_liquid: false
permalink: /posts/2024-09-21-rsync文件同步/
---

本文档介绍 rsync文件同步 的相关内容。

```bash
<a href="https://blog.51cto.com/colderboy/132054">https://blog.51cto.com/colderboy/132054</a>    rsync 参数
[root@bjdz-public-repo01-132114 cloud]# cat openstack-push-to-nj.sh

# !/bin/bash

# repo: centos[base,updates,extras]

# repo: epel

nfjd_openstack_rsync(){
  Logfile=/Yum/openstack-rsync.log
  Date=`date +"%F %T"`
  echo "${Date} nfjd_openstack_rsync" >> ${Logfile}
  sshpass='ssh -o StrictHostKeyChecking=no -p 8220'
  options='-auv --delete --bwlimit=5000 --timeout=30 root@1.2.3.4'

  rsync --rsh="${sshpass}" /Yum/cloud/centos/ ${options}:/Yum/cloud/centos/ &>> ${Logfile}
  rsync --rsh="${sshpass}" /Yum/cloud/openstack/ ${options}:/Yum/cloud/openstack/ &>> ${Logfile}
  rsync --rsh="${sshpass}" /Yum/cloud/ceph/ ${options}:/Yum/cloud/ceph/ &>> ${Logfile}

  echo '############################################' >> ${Logfile}
}

nfjd_openstack_rsync
[root@bjdz-public-repo01-132114 cloud]# sh -xxx openstack-push-to-nj.sh

+ nfjd_openstack_rsync
+ Logfile=/Yum/openstack-rsync.log
+ + date '+%F %T'
+ Date='2019-04-09 08:51:58'
+ echo '2019-04-09 08:51:58 nfjd_openstack_rsync'
+ sshpass='ssh -o StrictHostKeyChecking=no -p 8220'
+ options='-auv --delete --bwlimit=5000 --timeout=30 root@1.2.3.4'
+ rsync '--rsh=ssh -o StrictHostKeyChecking=no -p 8220' /Yum/cloud/centos/ -auv --delete --bwlimit=5000 --timeout=30 root@1.2.3.4:/Yum/cloud/centos/

nfjd_openstack_rsync(){
  Logfile=/Yum/openstack-rsync.log
  Date=`date +"%F %T"`
  echo "${Date} nfjd_openstack_rsync" >> ${Logfile}
  sshpass='ssh -o StrictHostKeyChecking=no -p 8220'
  options='-auv --delete --bwlimit=5120 --timeout=600 root@1.2.3.4'

  rsync --rsh="${sshpass}" /Yum/cloud/ceph/rpm-luminous ${options}:/Yum/cloud/ceph/rpm-luminous &>> ${Logfile}

  echo '############################################' >> ${Logfile}
}

nfjd_openstack_rsync

```
