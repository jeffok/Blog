---
title: redhat5.8根分区扩容，lvm分区扩容
date: 2023-04-25 17:45:00
tags: ["网络", "Linux", "RedHat"]
categories: ["Linux", "Redhat"]
render_with_liquid: false
permalink: /posts/2023-04-25-redhat5-8根分区扩容-lvm分区扩容/
---

本文档介绍 redhat5.8根分区扩容，lvm分区扩容 的相关内容。

## redhat 5.8 根分区扩容，lvm分区扩容

```bash
# !/bin/bash

# redhat 5.8 cloud set by jeff

# create new partition

fdisk /dev/vda <<EOF
m
n
p
3

t
3
8e
w
EOF

# load partition

partprobe

# add in lvmgroup

lvm <<EOF
pvcreate /dev/vda3
vgextend /dev/VolGroup00 /dev/vda3
vgdisplay
EOF

# 将获取到的硬盘大小减0.01G

a=`lvm vgdisplay |grep -i free|awk '{print $7}'`
b=0.01
DISK=$(echo "$a-$b" | bc)\G

# 扩大lvm分区

lvm lvextend -L +$DISK /dev/VolGroup00/LogVol00

# 修改文件系统大小以实现扩充空间

resize2fs -p /dev/VolGroup00/LogVol00
xfs_growfs /dev/centos/root   # xfs 扩容

# set hostname

urlhost=`curl -m 10 http://1.2.3.4/latest/meta-data/hostname`
HOST=`echo $urlhost |awk -F '.novalocal' '{print $1}'`
hostname $HOST\.opscloud
sed -i "s/^HOSTNAME=.*$/HOSTNAME=$HOST\.opscloud/g" /etc/sysconfig/network

# set ip static

eth0='/etc/sysconfig/network-scripts/ifcfg-eth0'

IP0=`cat /var/lib/dhclient/dhclient--eth0.lease |grep fixed-address |awk '{print $2}' |awk -F ';' '{print $1}'`
NET0=`cat /var/lib/dhclient/dhclient--eth0.lease |grep subnet-mask |awk '{print $3}' |awk -F ';' '{print $1}'`
GAT0=`cat /var/lib/dhclient/dhclient--eth0.lease |grep 'option routers' |awk '{print $3}' |awk -F ';' '{print $1}'`

  cat > $eth0 <<EOF
TYPE=Ethernet
DEVICE=eth0
NM_CONTROLLED=no
PEERDNS=no
BOOTPROTO=static
ONBOOT=yes
IPADDR=$IP0
NETMASK=$NET0
GATEWAY=$GAT0
EOF

history -c

> ~/.bash_history
reboot

```

```bash
# !/bin/bash

# redhat 5.8 resize lvm by jeff

# create new partition

fdisk /dev/vda <<EOF
m
n
p
3

t
3
8e
w
EOF

# load partition

partprobe

# add in lvmgroup

lvm <<EOF
pvcreate /dev/vda3
vgextend /dev/VolGroup00 /dev/vda3
vgdisplay
EOF

# 将获取到的硬盘大小减0.01G

a=`lvm vgdisplay |grep -i free|awk '{print $7}'`
b=0.01
DISK=$(echo "$a-$b" | bc)\G

# 扩大lvm分区

lvm lvextend -L +$DISK /dev/VolGroup00/LogVol00

# 修改文件系统大小以实现扩充空间

resize2fs -p /dev/VolGroup00/LogVol00

```
