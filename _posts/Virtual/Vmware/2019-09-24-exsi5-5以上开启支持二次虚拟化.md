---
title: exsi5.5以上开启支持二次虚拟化
date: 2019-09-24 10:26:00
tags: ["虚拟化", "CentOS", "Linux", "KVM", "VMware"]
categories: ["Virtual", "Vmware"]
render_with_liquid: false
permalink: /posts/2019-09-24-exsi5-5以上开启支持二次虚拟化/
---

本文档介绍 exsi5.5以上开启支持二次虚拟化 的相关内容。

exsi5.5上KVM二次虚拟化环境搭建
1)在exsi5.5上创建虚拟机centos(具体步骤省略)
2)开启exsi5.5的ssh功能
①用exsi5.5的客户端连接exsi5.5服务器端。点击exsi5.5物理机->配置选项卡->安全配置文件->服务的“属性”。
②选中ssh服务，点击”选项”->选择“手动启动或停止”->启动->确定->确定.
3)ssh登录exsi5.5
4)修改虚拟机的.vmx配置文件
进入exsi的shell界面，在cd /vmfs/volumes/datastore1/目录下，找到虚拟机名称对应的目录，例如虚拟机名称为centos
进入目录
打开centos.vmx文件，在末尾追加如下字段，保存退出。（也可以直接进入到硬盘直接修改该文件，再上传）
vi centos.vmx

nce.enable = TRUE
hypervisor.cpuid.v0 = FALSE
featMask.vm.hv.capable ="Min:1"
vhv.enable= TRUE

5)打开虚拟机电源，启动虚拟机。
6)用命令查看KVM模块是否加载成功。请确保虚拟机已经安装KVM模块。
//查看虚拟机是否已经安装KVM模块

# rpm -qa |grep kvm

//查看KVM模块是否加载成功

# lsmod | grep kvm

//查看CPU是否支持虚拟化

# grep -c ‘(vmx|svm)’/proc/cpuinfo
