---
title: mac常用操作
date: 2020-04-22 11:27:00
tags: ["Homebrew", "Mac", "macOS"]
categories: ["Mac"]
render_with_liquid: false
permalink: /posts/2020-04-22-mac常用操作/
---

本文档介绍 mac常用操作 的相关内容。

## sudo 使用touch id

```bash
sudo sed -i ".bak" '2s/^/auth       sufficient     pam_tid.so\'$'\n/g' /etc/pam.d/sudo

```

## 设置mac使用独立显卡

- 1）强制使用集成显卡

- sudo pmset -a GPUSwitch 0

- （2）强制使用独立显卡

- sudo pmset -a GPUSwitch 1

- （3）自动切换显卡

- sudo pmset -a GPUSwitch 2

- （4）当前显卡的使用状态

- pmset -g

- 查看 gpuswitch 对应值，0 是集成显卡，1 是独立显卡，2 是自动切换

## 安装ip r 命令

```text
brew install iproute2mac   mac支持ip a命令

```

## 允许所有来源应用

```bash
sudo spctl --master-disable   允许所有来源应用

```

## Mojave 桌面及开机启动桌面图片

```text
替换/Library/Desktop Pictures/Mojave.heic 就可以替换首次登陆的图片了。

```

## mac 支持mtr命令

```bash
mtr网络分析工具安装

1. 首先保证安装brew工具
2. 执行 brew cask mtr进行软件安装

3. 执行 alias mtr=/usr/local/sbin/mtr 启用别名

4. 配置PATH变量  vim ~/.bash_profile

export PATH=$PATH:/usr/local/sbin

5. 配置文件生效
source ~/.bash_profile

6. 使用mtr命令必须是root权限  当然也可以修改目录权限
sudo mtr www.baidu.com

brew install mtr
vim ~/.bash_profile

+ export PATH=$PATH:/usr/local/Cellar/mtr/0.92/sbin
source ~/.bash_profile

```

## mac 支持x11 dispaly virt-manager

```bash
# 如果需要mac支持远程服务器的图形界面，需要按以下内容进行配置

# 1.下载安装SDL库

http://www.libsdl.org/download-2.0.php
wget http://www.libsdl.org/release/SDL2-2.0.8.dmg

# 或使用工具下载

# Copy the SDL2.framework to /Library/Frameworks  # 将下载的文件打开后，copy到指定的目录中

# 2. 下载安装XQuartz

https://www.xquartz.org
wget https://dl.bintray.com/xquartz/downloads/XQuartz-2.7.11.dmg

# 下载完成后安装并注销或重启MAC电脑

# 3. 远程服务器需要打开（也可以不操作）

X11Forwarding yes
X11DisplayOffset 10
PrintMotd no
PrintLastLog yes
TCPKeepAlive yes

# 4. 连接远端服务器并启用XQuartz

ssh username@ip -Y    # -Y 启用XQuartz

```

## 调整launchpad图标大小

```bash
# 调整每一列显示图标数量，7 表示每一列显示7个

defaults write com.apple.dock springboard-rows -int 7

# 调整每一行显示图标数量，这里我用的是7

defaults write com.apple.dock springboard-columns -int 7

# 重启 Dock

killall Dock

# 由于修改了每一页显示图标数量，可能需要重置Launchpad

defaults write com.apple.dock ResetLaunchPad -bool TRUE;killall Dock

```

## Mac sudo 免密配置

```bash
# 切换至root用户下进行编辑

# 修改文件权限

chmod u+w /etc/sudoers

# 配置修改免密

vim /etc/sudoers
找到：

# root and users in group wheel can run anything on any machine as any user

root        ALL = (ALL) ALL
%admin      ALL = (ALL) ALL

修改为：

# root and users in group wheel can run anything on any machine as any user

# root       ALL = (ALL) ALL

# %admin     ALL = (ALL) ALL

root            ALL = (ALL) NOPASSWD: YOUR_PASSWORD ALL
%admin          ALL = (ALL) NOPASSWD: YOUR_PASSWORD ALL

# 测试

# 输入以下命令，如果需要密码，未配置成功，如果不需要说明配置成功

sudo -i

```

> 问题处理:
> 1. 如果出现权限问题，需要重启进行处理
> 2. 如终端出现类似以下问题
> ```

> sudo: /etc/sudoers is owned by uid 501, should be 0
> sudo: no valid sudoers sources found, quitting
> ```
> 重启电脑 ，然后在黑屏时长按
> ```

> Command + S
> ```
> 有可能系统会让你输入开机密码，输入密码后进入Root单用户模式，经过一些启动代码滚动后，系统提示你可以输入如下指令进入可写模式
> ```

> /sbin/fsck -fy
> ```
> 有可能会出现，如果没有看到，回车查看是否可以输入命令
> 输入后会执行一些磁盘检测，过后就可以执行重新获取权限的指令了
> 依次输入
> ```

> mount -uw /
> chown root:wheel /etc/sudoers
> chmod 440 /etc/sudoers
> ```
> 输入完成后就可以重新启动系统了，最后输入```reboot```
> 系统重启后，再次进入后调用终端，sudo就可以正常使用了。