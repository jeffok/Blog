---
title: ovs安装
date: 2024-02-25 11:51:00
tags: ["网络", "OpenVSwitch", "CentOS", "Linux"]
categories: ["Network", "Open vSwitch"]
render_with_liquid: false
permalink: /posts/2024-02-25-ovs安装/
---

本文档介绍 ovs安装 的相关内容。

## 从源码安装

### 一、获取源码

1. 安装依赖包

```bash
    [root@my-centos ~] yum install wget openssl-devel  python-sphinx gcc make python-devel openssl-devel kernel-devel graphviz kernel-debug-devel autoconf automake rpm-build redhat-rpm-config libtool python-twisted-core python-zope-interface PyQt4 desktop-file-utils libcap-ng-devel groff checkpolicy selinux-policy-devel gcc-c++ python-six unbound unbound-devel -y

```

2. 创建ovs用户并切换至ovs

```json
    [root@my-centos ~] adduser ovs
    [root@my-centos ~] su - ovs

```

3. 下载源码并准备编译环境

```json
    [ovs@my-centos ~] mkdir -p ~/rpmbuild/SOURCES
    [ovs@my-centos ~] cd ~/rpmbuild/SOURCES
    [ovs@my-centos SOURCES] wget http://openvswitch.org/releases/openvswitch-2.5.10.tar.gz
    [ovs@my-centos SOURCES] tar -zxvf openvswitch-2.5.10.tar.gz

```

### 二、编译源码

以ovs用户编译RPM包，之后退出登陆

```json
[ovs@my-centos SOURCES] rpmbuild -bb --nocheck openvswitch-2.5.10/rhel/openvswitch-fedora.spec
[ovs@my-centos SOURCES] exit

```

### 三、安装RPM包

以root用户安装编译好的RPM包

```bash
[root@my-centos ~] yum localinstall /home/ovs/rpmbuild/RPMS/x86_64/openvswitch-2.5.10-1.el7.centos.x86_64.rpm -y

```

### 四、验证是否安装，启动服务

```text
> ovs-vsctl --version
ovs-vsctl (Open vSwitch) 2.5.10
Compiled Aug  9 2020 17:29:38
DB Schema 7.12.1

```

启动服务，根据需要设置是否开机自启：

```bash
# 启动服务

> systemctl start openvswitch.service

# 检查服务状态

> systemctl status openvswitch.service
● openvswitch.service - Open vSwitch
   Loaded: loaded (/usr/lib/systemd/system/openvswitch.service; disabled; vendor pres
et: disabled)
   Active: active (exited) since Sun 2020-08-09 17:33:45 CST; 2s ago
  Process: 15621 ExecStart=/bin/true (code=exited, status=0/SUCCESS)
 Main PID: 15621 (code=exited, status=0/SUCCESS)
   CGroup: /system.slice/openvswitch.service

Aug 09 17:33:45 VM_0_17_centos systemd[1]: Starting Open vSwitch...
Aug 09 17:33:45 VM_0_17_centos systemd[1]: Started Open vSwitch.

# 如有需要，设置服务开机自启

> systemctl enable openvswitch.service

```

最后检查服务是否已经启动：

```sql
> ovs-vsctl show
93415cc9-53b0-44da-a2d7-17e42b4a5ed1
    ovs_version: "2.5.10"

```
